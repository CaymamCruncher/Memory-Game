const cardDeck=document.querySelector(".deck"),cardValues=document.querySelectorAll(".card>i"),cardClass=[],cards=document.querySelectorAll(".card"),container=document.querySelector(".container"),victoryScreen=document.querySelector(".victory"),starNumber=document.querySelector(".stars"),restartButton=document.querySelectorAll(".fa-repeat"),resetStar=document.querySelectorAll(".stars>li"),optionsButton=document.querySelector(".fa-cog"),sixteenTileButton=document.getElementById("16-tile"),twentyTileButton=document.getElementById("20-tile"),timedButton=document.getElementById("timed-button"),moveButton=document.getElementById("move-button");let interval,timer=document.querySelector(".timer"),minutes=0,seconds=0,restarting=!1,score=document.querySelector(".score"),moveCount=document.querySelector(".moves"),moveValue=0,starLoss=15,starScore=3,twentyTile=!1,timerStarted=!1,hardMode=!1;function shuffle(e){for(var t,r,a=e.length;0!==a;)r=Math.floor(Math.random()*a),t=e[a-=1],e[a]=e[r],e[r]=t;return e}function flipCard(e){timerStarted||startTimer(),e.target.className.includes("card")&&!e.target.className.includes("match")&&(e.target.className+=" open show",checkNumCards())}function checkNumCards(){let e=document.querySelectorAll(".open");if(e.length>1){cardDeck.removeEventListener("click",flipCard),moveValue+=1,moveCount.textContent=hardMode?24-moveValue+" Moves Remaining":moveValue+" Moves",loseStar(),cardsMatch(e)?(e[0].className="card match",e[1].className="card match",cardDeck.addEventListener("click",flipCard),gameWon()?endGame():hardMode&&moveValue>=24&&(alert("You ran out of moves!!!"),restartGame())):(e[0].className+=" wrong",e[1].className+=" wrong",setTimeout((function(){e[0].className="card",e[1].className="card",cardDeck.addEventListener("click",flipCard)}),900),hardMode&&moveValue>=24&&(alert("You ran out of moves!!!"),restartGame()))}}function cardsMatch(e){return e[0].firstElementChild.className===e[1].firstElementChild.className}function gameWon(){for(let e of cards)if(!e.classList.contains("match"))return!1;return cardDeck.removeEventListener("click",flipCard),!0}function endGame(){container.style.display="none",victoryScreen.style.display="flex",score.textContent="You won in "+moveValue+" moves with "+starScore+" stars! Your final time was "+timer.textContent,stopTimer()}function loseStar(){if(moveValue>=starLoss){if(twentyTile&&starLoss>30)return;if(starLoss>25&&!twentyTile)return;starNumber.removeChild(starNumber.firstElementChild),starLoss+=10,starScore-=1}}function restartGame(e=!1){let t=document.querySelectorAll(".deck>li");for(let e=0;e<starNumber.children.length;e++)starNumber.append(resetStar[e]),e<2&&(starNumber.children[e].style.margin="0 3px 0 0");for(let e=0;e<t.length;e++)t[e].className="card";moveValue=0,hardMode?(moveCount.textContent="24 Moves Remaining",e=!0):moveCount.textContent="0 Moves",starLoss=twentyTile?19:15,starScore=3,restarting=!0,container.style.display="flex",victoryScreen.style.display="none",cardDeck.addEventListener("click",flipCard),stopTimer(),randomizeCards(),e&&startTimer(e)}function randomizeCards(){for(let e of cardValues)restarting||cardClass.push(e.className),e.className="fa";shuffle(cardClass);for(let e=0;e<cardClass.length;e++)(cardClass[e].includes("fa-money")||cardClass[e].includes("fa-car"))&&(cardValues[e].parentElement.className=twentyTile?"card":"card hidden match"),cardValues[e].className=cardClass[e]}function startTimer(e=!1){timerStarted=!0,e?(e=!1,minutes=5,seconds=0,interval=setInterval((function(){0===seconds&&(minutes-=1,seconds=60),seconds-=1,timer.textContent=seconds<10?minutes+":0"+seconds:minutes+":"+seconds,0===minutes&&0===seconds&&(alert("Out of time!!!"),restartGame())}),1e3)):interval=setInterval((function(){60===(seconds+=1)&&(minutes+=1,seconds=0),timer.textContent=seconds<10?minutes+":0"+seconds:minutes+":"+seconds}),1e3)}function stopTimer(){clearInterval(interval),gameWon()||(seconds=0,minutes=0,timerStarted=!1,timer.textContent="00:00")}function toggleOptions(){let e=document.querySelector(".options-menu");"flex"!=e.style.display?e.style.display="flex":e.style.display="none"}function changeTiles(e){twentyTile=e,restartGame()}function startHardMode(){!0===hardMode?(hardMode=!1,restartGame()):(hardMode=!0,restartGame(!0))}randomizeCards(),cardDeck.addEventListener("click",flipCard),restartButton[0].addEventListener("click",()=>restartGame()),restartButton[1].addEventListener("click",()=>restartGame()),optionsButton.addEventListener("click",toggleOptions),sixteenTileButton.addEventListener("click",()=>changeTiles(!1)),twentyTileButton.addEventListener("click",()=>changeTiles(!0)),timedButton.addEventListener("click",()=>restartGame(!0)),moveButton.addEventListener("click",startHardMode);